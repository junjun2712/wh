# wh
外汇

mt5和mt4的跟单方式可以粗略分为本地跟单和远程跟单，其根本原理就是将某个账号的做单信息共享出来（下面我们称这个账号为主账号），然后根据这个账号的信息进行做单，手数、方向、货币都可以进行相应的处理。

首先我们得确立几个知识点：
  1、mt4和mt5的编译环境中，对于文件的读写并不是那么友好，它只能识别数据文件夹下面的文件，对于其他地方的文件不能识别
  2、在window下面，当程序在运行的时候，除了会加载自带的dll文件之外，还会加载system32下面的dll文件。明明是mt4/mt5开发，为什么会提到window自带的dll呢？看完全部自然会明白的。

本地跟单其实可以分为两种，一直是通过内存共享数据，还有一种是通过文件共享数据。内存共享数据本人没有研究过，所以在此不做讲解。在此讲解的是通过文件共享数据实现跟单，就是将主账号的做单信息写入文件中，然后其他账号的来读取这个文件的信息，实现跟单。但是mt4/5编程中，文件的读写只能在它的文件盒子下面进行，所以导致了两个mt4/5客户端不能共享数据，这个时候我们需要借助系统自带的kernel32dll动态库了。

kernel32.dll里面有上千个函数，我们只需要其中的两个函数就够了，CopyFileW和CreateDirectoryW，CopyFileW是将主账号的做单信息文件复制到某个固定的文件夹中，然后其他账号也是通过这个函数将此文件复制到本账号的文件盒子中，以此达到数据共享。CreateDirectoryW函数可用可不用，但是为了方便，我们还是调用该函数，为了创建一个数据跟单软件的专属文件夹，这样就完美了。

 贴上引入dll的源码：

#import "kernel32.dll"
int  CopyFileW(string a0, string a1, int a2);
bool CreateDirectoryW(string a0,int a1);
#import

